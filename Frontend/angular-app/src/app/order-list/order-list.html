<div class="order-management-container">
  <header class="menu-header">
    <h1>Bestellungen</h1>
  </header>

  <div class="filter-container">
    <div class="filter-group">
      <span>Gruppieren nach:</span>
      @for (option of groupOptions; track option) {
        <button 
          class="filter-btn"
          [class.active]="activeGroup === option"
          (click)="activeGroup = option">
          {{ option }}
        </button>
      }
    </div>
  </div>

  <main class="order-list">
    @for (group of groupedOrders | keyvalue; track group.key) {
      <div class="order-group">
        <h3>{{ group.key }}</h3>
        
        @for (item of group.value; track item.menuItem.id + item.user.id) {
          <div class="order-card">
            <div class="order-summary">
              <div class="order-info">
                <h2>{{ item.menuItem.title }} × {{ item.quantity }}</h2>
                <p class="meta">
                  <span>{{ item.menuItem.price * item.quantity | currency:'EUR' }}</span> · 
                  <span>Lieferzeit: {{ item.deliveryTime }}</span> · 
                  <span>Bestellt von: <a (click)="navigateToUser(item.user.id)">{{ item.user.name }}</a></span>
                </p>
                @if (item.note) {
                  <p class="note">Anmerkung: {{ item.note }}</p>
                }
              </div>

              <div class="order-controls">
                <label class="delivery-toggle">
                  <input type="checkbox" 
                         [(ngModel)]="item.delivered" 
                         (change)="toggleDelivered(item)" />
                  <span class="toggle-label">{{ item.delivered ? 'Geliefert' : 'Ausstehend' }}</span>
                </label>
              </div>
            </div>
          </div>
        }
      </div>
    }
  </main>

  <footer class="order-footer">
    <div class="footer-grid">
      <div class="footer-item">
        <i class="icon-receipt"></i>
        <div class="footer-text">
          <span>Gesamtsumme</span>
          <strong>{{ totalSum | currency:'EUR' }}</strong>
        </div>
      </div>
    </div>
  </footer>
</div>